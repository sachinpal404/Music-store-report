music answers
A2.--A2

with popular_genre as (
			select c.country , sum(quantity) , g.name , g.genre_id ,
			row_number() over(partition by c.country order by sum(il.quantity) desc) as rowno
			from customer c
			join invoice i on c.customer_id = i.customer_id 
			join invoice_line il on il.invoice_id = i.invoice_id 
			join track t on t.track_id = il.track_id 
			join genre g on g.genre_id = t.genre_id
			group by 1 ,3 , 4
			order by 1 asc , 2  desc 
)
select * from popular_genre where rowno = 1 ;





A3.--A3
with customer_with_country as(
      select c.customer_id, first_name, last_name, country, sum(total) as total_bill from customer c
	  join invoice i on c.customer_id = i.customer_id 
	  group by 1,2,3,4
	  order by 1,5 desc),

	 country_max_spendings as(
	  select country, max(total_bill) as bill from customer_with_country
	  group by country)
	
select cwc.country, customer_id, first_name, last_name, total_bill from customer_with_country cwc
join country_max_spendings cms on cwc.country = cms.country
where cwc.total_bill = cms.bill
order by 1 ;   